/**
 * @fileOverview 企鹅医典，医学科普头条
 * @author yeonzhou
 * @version v1.0.5
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.VueNavigation=n()}(this,function(){"use strict";var e=[];window.sessionStorage.VUE_NAVIGATION&&(e=JSON.parse(window.sessionStorage.VUE_NAVIGATION));var w=e;function I(e,n){return(e.name||e.path)+"?"+e.query[n]}function f(e,n){if(e.length){var t=e.indexOf(n);if(-1<t)return e.splice(t,1)}}function l(e,n,t,r){var o=e[n];!o||r&&o.tag===r.tag||o.componentInstance.$destroy(),e[n]=null,f(t,n)}var h=function(O,e,x){return{record:function(e,n,t){var r,o,i,a,s,u,c,f,l,h,d,g,y,p,m,v=I(e,x);if(t)g=v,y={route:e},(p={route:n}).name=(m=w)[m.length-1]||null,y.name=g,m.splice(w.length-1,1,g),window.sessionStorage.VUE_NAVIGATION=JSON.stringify(m),O.$emit("replace",y,p);else{var N=w.lastIndexOf(v);-1===N?(f=v,l={route:e},(h={route:n}).name=(d=w)[d.length-1]||null,l.name=f,d.push(f),window.sessionStorage.VUE_NAVIGATION=JSON.stringify(d),O.$emit("forward",l,h)):N===w.length-1?((s={route:e}).name=(u={route:n}).name=(c=w)[c.length-1],O.$emit("refresh",s,u)):(r=w.length-1-N,o={route:e},(i={route:n}).name=(a=w)[a.length-1],o.name=a[a.length-1-r],a.splice(w.length-r,r),window.sessionStorage.VUE_NAVIGATION=JSON.stringify(a),O.$emit("back",o,i))}},reset:function(){w.splice(0,w.length),window.sessionStorage.VUE_NAVIGATION=JSON.stringify([]),O.$emit("reset")}}},d=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};function g(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}return{install:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=n.router,r=(n.moduleName,n.keyName),o=void 0===r?"VNK":r;if(t){var i,a=new e,s=h(a,0,o),u=t.replace.bind(t),c=!1;t.replace=function(e,n,t){c=!0,u(e,n,t)},t.beforeEach(function(e,n,t){if(e.query[o])t();else{var r=d({},e.query);e.path===n.path&&function(e,n){if(e===n)return!0;var t=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(n);if(t.length!==r.length)return!1;var o=!0,i=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value;if(e[c]!==n[c])return!1}}catch(e){i=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw a}}return!0}(d({},e.query,g({},o,null)),d({},n.query,g({},o,null)))&&n.query[o]&&(c=!0),r[o]="xxxxxxxx".replace(/[xy]/g,function(e){var n=16*Math.random()|0;return("x"===e?n:3&n|8).toString(16)}),t({path:e.path,query:r,replace:c||!n.query[o],hash:e.hash||""})}}),t.afterEach(function(e,n){s.record(e,n,c),c=!1}),e.component("navigation",(i=o,{name:"navigation",abstract:!0,props:{include:[String,Array],exclude:[String,Array],max:[String,Number]},data:function(){return{routes:w}},computed:{},watch:{routes:function(e){for(var n in this.cache)if(r=e,o=n,!(Array.isArray(r)?-1<r.indexOf(o):"string"==typeof r&&-1<r.split(",").indexOf(o))){var t=this.cache[n];t&&t.componentInstance.$destroy(),delete this.cache[n]}var r,o}},created:function(){this.cache={},this.keys=[]},destroyed:function(){for(var e in this.cache)l(this.cache,e,this.keys)},render:function(){var e=this.$slots.default?this.$slots.default[0]:null;if(e){e.key=e.key||(e.isComment?"comment":e.tag);var n=this.cache,t=this.keys,r=I(this.$route,i);-1===e.key.indexOf(r)&&(e.key="__navigation-"+r+"-"+e.key),n[r]?(e.key===n[r].key?e.componentInstance=n[r].componentInstance:(n[r].componentInstance.$destroy(),n[r]=e),f(t,r),t.push(r)):(n[r]=e,t.push(r),this.max&&t.length>parseInt(this.max)&&l(n,t[0],t,this._vnode)),e.data.keepAlive=!0}return e}})),e.navigation=e.prototype.$navigation={on:function(e,n){a.$on(e,n)},once:function(e,n){a.$once(e,n)},off:function(e,n){a.$off(e,n)},getRoutes:function(){return w.slice()},cleanRoutes:function(){return s.reset()}}}else console.error("vue-navigation need options: router")}}});